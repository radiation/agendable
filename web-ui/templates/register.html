<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Register</title>
    <!-- HTMX core -->
    <script src="https://unpkg.com/htmx.org@1.9.2"></script>
    <!-- HTMX JSON-encoding extension -->
    <script src="https://unpkg.com/htmx.org@1.9.2/dist/ext/json-enc.js"></script>
  </head>
  <body>
    <h1>Create an Account</h1>

    <form
      id="register-form"
      hx-post="/auth/register"
      hx-ext="json-enc"
      hx-headers='{"Content-Type": "application/json"}'
      hx-target="#feedback"
      hx-swap="innerHTML"
      hx-on="htmx:afterRequest:
        if (event.detail.xhr.status === 200) {
          const p = new URLSearchParams({
            email:      email.value,
            password:   password.value,
            first_name: first_name.value,
            last_name:  last_name.value
          });
          window.location = '/profile?' + p;
        }"
    >
      <div>
        <label for="email">Email</label><br/>
        <input id="email" name="email" type="email" required />
      </div>

      <div>
        <label for="password">Password</label><br/>
        <input id="password" name="password" type="password" required />
      </div>

      <div>
        <label for="first_name">First Name</label><br/>
        <input id="first_name" name="first_name" type="text" required />
      </div>

      <div>
        <label for="last_name">Last Name</label><br/>
        <input id="last_name" name="last_name" type="text" required />
      </div>

      <button type="submit">Sign up</button>
    </form>

    <div id="feedback" style="margin-top:1em;"></div>
  </body>
</html>
